{# minha_producao_diaria/producao/templates/producao/editar_producao.html #}

{% extends 'base.html' %} {# Extende o template base #}

{% block title %}Editar Produção{% endblock %}

{% block extra_head %}
<style>
    /* Mantenha os estilos que você já tem em adicionar_producao.html */
    /* Pode copiar e colar a seção <style> inteira do adicionar_producao.html aqui */
    /* Ou, idealmente, mover os estilos comuns para um arquivo CSS estático */

    /* Exemplo (copie tudo do adicionar_producao.html): */
    .form-container {
        background-color: #fff;
        padding: 30px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        max-width: 600px;
        margin: 20px auto;
    }
    .form-group {
        margin-bottom: 15px;
    }
    .form-group label {
        display: block;
        margin-bottom: 5px;
        font-weight: bold;
    }
    .form-group input[type="text"],
    .form-group input[type="date"],
    .form-group input[type="number"] {
        width: calc(100% - 22px);
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 4px;
        box-sizing: border-box;
    }
    .form-row {
        display: flex;
        gap: 20px;
        margin-bottom: 15px;
    }
    .form-row > div {
        flex: 1;
    }
    .button-group {
        text-align: right;
        margin-top: 20px;
    }
    .button-group button {
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
        margin-left: 10px;
    }
    .button-group .save-button {
        background-color: #28a745;
        color: white;
    }
    .button-group .save-button:hover {
        background-color: #218838;
    }
    .button-group .clear-button {
        background-color: #ffc107;
        color: #333;
    }
    .button-group .clear-button:hover {
        background-color: #e0a800;
    }
    .button-group .list-button {
        background-color: #17a2b8;
        color: white;
    }
    .button-group .list-button:hover {
        background-color: #138496;
    }
    .messages {
        list-style: none;
        padding: 10px;
        margin: 10px 0;
        border-radius: 5px;
        font-size: 0.9em;
    }
    .messages li {
        margin-bottom: 5px;
    }
    .messages .success {
        background-color: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
    }
    .messages .error {
        background-color: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
    }

    /* Novas regras para layout responsivo dos inputs do formulário */
    .form-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); /* Ajusta para 2 colunas ou 1, dependendo da tela */
        gap: 15px;
    }

    /* Estilo específico para inputs de cálculo */
    input[name="total_imoveis_abertos"] {
        font-weight: bold;
        background-color: #e9ecef;
        color: #495057;
    }

    /* Estilos para o grupo de checkboxes */
    .checkbox-group {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        margin-top: 10px;
        margin-bottom: 15px;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 4px;
        background-color: #f8f8f8;
    }

    .checkbox-group div {
        display: flex;
        align-items: center;
    }

    .checkbox-group label {
        margin-left: 5px;
        margin-bottom: 0; /* Remover margem inferior padrão da label */
        font-weight: normal; /* Labels de checkbox geralmente não são bold */
    }
</style>
{% endblock %}

{% block content %}
<div class="form-container">
    <h2>Editar Produção Diária</h2> {# <-- Título alterado #}
    <form method="post" id="producao-form">
        {% csrf_token %}

        <div class="form-grid">
            <div class="form-group">
                <label for="{{ form.data.id_for_label }}">Data:</label>
                {{ form.data }}
            </div>
            <div class="form-group">
                <label for="{{ form.bairro.id_for_label }}">Bairro:</label>
                {{ form.bairro }}
            </div>
            <div class="form-group">
                <label for="{{ form.ciclo_ano.id_for_label }}">Ciclo/Ano:</label>
                {{ form.ciclo_ano }}
            </div>
            <div class="form-group">
                <label for="{{ form.nome_responsavel.id_for_label }}">Responsável:</label>
                {{ form.nome_responsavel }}
            </div>
            <div class="form-group">
                <label for="{{ form.numero_identificacao.id_for_label }}">Nº Identificação:</label>
                {{ form.numero_identificacao }}
            </div>
            <div class="form-group">
                <label for="{{ form.numero_quarteirao.id_for_label }}">Nº Quarteirão:</label>
                {{ form.numero_quarteirao }}
            </div>
            <div class="form-group">
                <label for="{{ form.semana_epidemiologica.id_for_label }}">Semana Epidemiológica:</label>
                {{ form.semana_epidemiologica }}
            </div>
        </div>

        <hr>
        <h3>Tipos de Imóveis</h3>

        <div class="form-grid">
            <div class="form-group">
                <label for="{{ form.residencia.id_for_label }}">Residência:</label>
                {{ form.residencia }}
            </div>
            <div class="form-group">
                <label for="{{ form.comercio.id_for_label }}">Comércio:</label>
                {{ form.comercio }}
            </div>
            <div class="form-group">
                <label for="{{ form.terreno_baldios.id_for_label }}">Terreno Baldio:</label>
                {{ form.terreno_baldios }}
            </div>
            <div class="form-group">
                <label for="{{ form.ponto_estrategico.id_for_label }}">Ponto Estratégico:</label>
                {{ form.ponto_estrategico }}
            </div>
            <div class="form-group">
                <label for="{{ form.outros.id_for_label }}">Outros:</label>
                {{ form.outros }}
            </div>
            <div class="form-group">
                <label for="{{ form.total_imoveis_abertos.id_for_label }}">Total de Imóveis Abertos:</label>
                {{ form.total_imoveis_abertos }}
            </div>
        </div>

        <hr>
        <h3>Resultados da Visita</h3>

        <div class="form-grid">
            <div class="form-group">
                <label for="{{ form.eliminados.id_for_label }}">Eliminados:</label>
                {{ form.eliminados }}
            </div>
            <div class="form-group">
                <label for="{{ form.recusas.id_for_label }}">Recusas:</label>
                {{ form.recusas }}
            </div>
            <div class="form-group">
                <label for="{{ form.fechados.id_for_label }}">Fechados:</label>
                {{ form.fechados }}
            </div>
            <div class="form-group">
                <label for="{{ form.recuperados.id_for_label }}">Recuperados:</label>
                {{ form.recuperados }}
            </div>
        </div>

        <div class="button-group">
            <button type="button" class="list-button" onclick="location.href='{% url 'listar_producoes' %}'">Voltar para a Lista</button>
            <button type="submit" class="save-button">Atualizar Produção</button>
        </div>
    </form>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const residenciaInput = document.getElementById('id_residencia');
        const comercioInput = document.getElementById('id_comercio');
        const terrenoBaldiosInput = document.getElementById('id_terreno_baldios');
        const pontoEstrategicoInput = document.getElementById('id_ponto_estrategico');
        const outrosInput = document.getElementById('id_outros');
        const totalImoveisAbertosInput = document.getElementById('id_total_imoveis_abertos');

        function calcularTotal() {
            const residencia = parseInt(residenciaInput.value) || 0;
            const comercio = parseInt(comercioInput.value) || 0;
            const terrenoBaldios = parseInt(terrenoBaldiosInput.value) || 0;
            const pontoEstrategico = parseInt(pontoEstrategicoInput.value) || 0;
            const outros = parseInt(outrosInput.value) || 0;

            const total = residencia + comercio + terrenoBaldios + pontoEstrategico + outros;
            totalImoveisAbertosInput.value = total;
        }

        residenciaInput.addEventListener('input', calcularTotal);
        comercioInput.addEventListener('input', calcularTotal);
        terrenoBaldiosInput.addEventListener('input', calcularTotal);
        pontoEstrategicoInput.addEventListener('input', calcularTotal);
        outrosInput.addEventListener('input', calcularTotal);

        // Inicializa o total ao carregar a página
        calcularTotal();
    });
</script>
{% endblock %}